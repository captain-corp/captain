{{ template "admin_header.tmpl" . }}
<div class="admin-page">
    <div class="page-header">
        <h1>Create New Page</h1>
    </div>
    <div class="editor-container">
        <form method="POST" action="/admin/pages/create" id="pageForm">
            <div class="form-group">
                <label for="title">Title</label>
                <input type="text" id="title" name="title" class="form-control" required>
            </div>
            <div class="form-group">
                <label for="slug">Slug</label>
                <input type="text" id="slug" name="slug" class="form-control" required>
                <small class="help-text">The URL-friendly version of the title</small>
            </div>
            <div class="form-group">
                <label for="content_type">Content Type</label>
                <select id="content_type" name="content_type" class="form-control">
                    <option value="markdown">Markdown</option>
                    <option value="html">HTML</option>
                </select>
            </div>
            <div class="form-group editor-wrapper">
                <div class="editor-toolbar">
                    <label for="content">Content:</label>
                    <div class="preview-toggle">
                        <button type="button" id="edit-mode" class="active">Edit</button>
                        <button type="button" id="preview-mode">Preview</button>
                    </div>
                </div>
                <div id="editor-area">
                    <textarea id="content" name="content" class="form-control content-editor" required=""></textarea>
                    <div id="preview-area" class="markdown-preview" style="display: none;"></div>
                </div>
            </div>
            <div class="form-group">
                <label class="checkbox-label">
                    <input type="checkbox" name="visible" id="visible" checked>
                    Visible
                </label>
                <small class="help-text">When checked, the page will be visible to the public</small>
            </div>
            <div class="form-actions">
                <button type="submit" class="btn btn-primary">Create Page</button>
                <a href="/admin/pages" class="btn">Cancel</a>
            </div>
        </form>
    </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
    const titleInput = document.getElementById('title');
    const slugInput = document.getElementById('slug');

    function generateSlug(text) {
        return text
            .toLowerCase()
            .replace(/[^a-z0-9]+/g, '-')
            .replace(/^-+|-+$/g, '');
    }

    titleInput.addEventListener('input', function() {
        if (!slugInput.value || slugInput.value === slugInput.defaultValue) {
            slugInput.value = generateSlug(this.value);
        }
    });
});
</script>

{{ template "admin_footer.tmpl" . }}